<html>
	<head>
		<title>Pong - the chat page</title>
		<meta charset="utf-8" />
		<meta name="description" content="Discutes avec tes amis et c'est parti pour des heures de fun !" />
		<meta name="author" content="Team transcendance 42" />
		<meta name="copyright" content="© CC BY-NC-SA 4.0" />
	</head>
	<body>
		<div class="center">
			<div class="quart">
				Et ça c'est le quart !
				<mat-tab-group id="mat-tab-group" [selectedIndex]="selected.value">
					<mat-tab label="Mes groupes">
						<ul>
							<li *ngFor="let room of (rooms$ | async)" [value]="room">
								<p class="roomName" (click)="selectRoom(room)">{{room.name}}</p>
							</li>
						</ul>
					</mat-tab>
					<mat-tab label="Mes amis">
						<ul>
							<li>mon ami joe</li>
							<li>mon ami joe</li>
							<li>mon ami joe</li>
							<li>mon ami joe</li>
							<li>mon ami joe</li>
							<li>mon ami joe</li>
						</ul>
					</mat-tab>
				</mat-tab-group>
				<a class="button" href= "http://localhost:3000/api/v1/auth/42">+ Nouveau groupe</a>
			</div>
			<div class="troisquart">
				<p>c'est le trois quart</p>
				<app-room [room]="selectedRoom" [user]="actualUser"></app-room>
			</div>
		</div>
	</body>
</html>

<div class="container">
  <div>
	<mat-card>
	  <mat-card-title>Nouveau groupe</mat-card-title>
	  <mat-card-content>
		<form [formGroup]="form" (ngSubmit)="create()">
		  <mat-form-field>
			<input type="text" matInput placeholder="Nom du groupe" default="caca" formControlName="name">
			<mat-error *ngIf="name.touched && name.hasError('required')">Nom de votre groupe</mat-error>
		  </mat-form-field>
		  <mat-form-field>
			<input type="text" matInput placeholder="Description" formControlName="description">
		  </mat-form-field>
		  <mat-checkbox matCheckBox formControlName="public">Public</mat-checkbox>
		  <mat-form-field *ngIf="public.value">
			<mat-label>Mot de passe</mat-label>
			<input matInput type="password" formControlName="password">
		  </mat-form-field>
		  <app-userselect [users]="users.value" (addUser)="addUser(initUser($event))" (removeuser)="removeUser($event.id)"></app-userselect>
		  <div class="button">
			<button mat-button type="submit" [disabled]="!form.valid">Créer</button>
		  </div>
		</form>
	  </mat-card-content>
	</mat-card>
	
  </div>
</div>
<mat-tab-group id="mat-tab-group" style="overflow-y: auto; height: 50%" [selectedIndex]="selected.value">
  <mat-tab label="Groupe">
	  <mat-card>
		<div style="display: flex; flex-direction: row;">
		  <div>
			<h2>Vos groupes</h2>
			<mat-selection-list #rooms [multiple]="false" (selectionChange)="onSelectedRoom($event)">
			  <mat-list-option *ngFor="let room of (rooms$ | async)" [value]="room">
				<div>
				  <h3>{{room.name}}</h3>
				  <mat-divider></mat-divider>
				</div>
			  </mat-list-option>
			</mat-selection-list>
		  </div>
			<app-room [room]="selectedRoom" [user]="actualUser">
				
			</app-room>
		  </div>
	  </mat-card>
  </mat-tab>
  <mat-tab label="Informations du groupe" *ngIf = "selectedRoom.name">
	<app-chat-info [room]="(selectedRoom)">
	</app-chat-info>
  </mat-tab>
<mat-tab *ngIf="isAdmin" label="Paramètres du groupe">
  <app-edit-room-chat [room]="selectedRoom">
  </app-edit-room-chat>
</mat-tab>
<mat-tab label="Groupes public">

  <mat-list>
	<mat-list-item *ngFor="let room of (publicrooms | async)">
	  <h3 matLine> {{room.name}}  </h3>  
	  <h4 matLine style="color:gray"> {{room.description}} </h4>
	  <h6 matLine style="color: gray ; font-size: 12px">Avec 
		<span *ngFor="let user of room.users">
		  {{user.intra_name}}
		  <span *ngIf="user && room && room.users && room.users[room.users.length - 1] !== user">, </span>
		</span>
	  </h6>
	  <ng-container *ngIf="room.password">
		<mat-icon *ngIf="room.password" matTooltip="Mot de passe nécéssaire" style="margin-right:14px; color:salmon">key</mat-icon>
	  </ng-container>
	  <button style="color: green"  mat-Button matTooltip="Rejoindre le groupe" (click)="joinRoom(room, room.password !== null)">
		  <mat-icon>add</mat-icon>
	  </button>
		<mat-divider></mat-divider>
	</mat-list-item>
  </mat-list>
</mat-tab>

<div class="container">
  
</div>

<ng-template #no_rooms>
  <p style="margin: 25px">Vous n'avez pas encore de groupe</p>
</ng-template>
